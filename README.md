# vsCodeTalker

vsCode内のテキストを各種日本語向けの音声合成エンジンで読み上げたりできる拡張機能
動画での概要説明が[ニコニコ動画](https://www.nicovideo.jp/watch/sm39970656)にあります

<!--
四国めたん＞Visual Studio Code内のテキストを読み上げたり録音する拡張機能を作りました。
ずんだもん＞とりあえず読み上げてほしい時には役に立つと思うのだ。でも、どうして攻撃力2300ぐらいの名前にしたのだ？
四国めたん＞日本語用なのが推測できて、名前から何をする拡張機能なのか判別できそうだったからよ。
四国めたん＞現状でもテキストファイルの内容から、aviUtilを使った動画を作れるようにはなってると思うのだわ。
 -->

## 使い方(Usage)
**事前に以下「対応している音声合成エンジン」セクション内いずれかのインストールが必要です**
1. 拡張機能をインストールする
2. プレーンテキスト(.txtなど)、マークダウン(.md)を開く
   1. 初回起動時に使用可能な音声合成ライブラリの一覧を取得します
3. `vsCodeTalker.talk`や`vsCodeTalker.record`を実行すると音声再生や録音ができます

<!-- 
四国めたん＞次に拡張機能の使い方です。
四国めたん＞前提として、読み上げに使う音声合成エンジンをインストールしておく必要があるわ。
雫＞エーアイボイスや、ボイスロイド2を使うには各ライブラリのインストールが必要になります。
四国めたん＞この拡張機能をインストールした後にプレーンテキストや、マークダウンのファイルを開くと自動で使用可能な音声合成ライブラリの一覧を取得するわ。
四国めたん＞あとは各コマンドを実行すると読み上げるわ。
四国めたん＞まずはボイスボックスをインストールしておいて、動作確認することをおすすめするわ。
 -->
### 対応している音声合成エンジン
windows 10 64bitで動作確認済みのもの
* [VOICEVOX](https://voicevox.hiroshiba.jp)
  * 読み上げの前にVOICEVOX本体を立ち上げておく必要あり
* Voiceroid2(64bit版のみ)
* [A.I.Voice](https://aivoice.jp/)
* [CeVIO AI](https://cevio.jp/products_cevio_ai/)
* [CeVIO CS7](https://cevio.jp/product/ccs/)
* [voicepeak](https://www.ah-soft.com/voice/)
  * コマンドラインの仕様上、現状では部分的な対応となります(ボイスプリセットの種類のみ指定可)

<!-- 
四国めたん＞次は対応状況よ。
四国めたん＞とりあえず、ボイスボックスで動くところまでは確認したわ。
ずんだもん＞"つむぎ"とか、最近ボイボ寮に来た子は対応できていないのだ。
きりたん＞ボイスロイドプラスでも、64ビット版のボイスロイド２に移行すれば読み上げできます。
 -->
### コマンド一覧
* vsCodeTalker.getLibraryList 
  * 利用可能なttsライブラリを取得 初回起動時に実行されます
* vsCodeTalker.talk
  * 現在の行を読み上げ
* vsCodeTalker.record
  * 現在の行を読み上げて録音
* vsCodeTalker.talkAllLineHasSeparator
  * ファイル内のボイスプリセットを含む行を読み上げ
* vsCodeTalker.recordAllLineHasSeparator
  * ファイル内のボイスプリセットを含む行を録音し読み上げ
* vsCodeTalker.openDestinationFolder
  * 音声保存先のフォルダを開く

<!-- 
四国めたん＞次にコマンド一覧になるわ。
四国めたん＞このうち、ライブラリ取得は初回起動時に自動実行されるわ・
ずんだもん＞もし使える音声合成ライブラリを増やしたら、再度実行してほしいのだ。
四国めたん＞このリードミーでも一応のテストはできるようになっているわ。
IA＞各種音声合成ライブラリで作成しておいたプリセットの名前をそのまま参照しているよ。
 -->
## 機能(Features)

 - [x] 使用可能な音声合成ライブラリの取得
 - [x] 選択範囲orカーソルのある行に対しての処理
   - [x] 読み上げ
   - [x] 読み上げ+録音
 - [x] ボイスプリセットを含む行の一括処理
   - [x] 読み上げ
   - [x] 読み上げ+録音
 - [x] 録音ファイルの保存先フォルダを開く

ボイスプリセットを含む行は以下サンプルです  
名前＞読み上げのテストです

<!-- 
四国めたん＞次に今実装している機能よ。
四国めたん＞ デフォルトだと、ボイスプリセットのための区切り文字はボイスロイド2に合わせてあるわ。
ずんだもん＞ 使える機能についてはF1を押して、ブイエスコードトーカー とタイプすると見れるのだ。
ブイエスコードトーカー:vsCodeTalker
 -->
## 動作環境(Requirements)

windows10以降
<!-- 
四国めたん＞ このツールから呼び出す音声合成ライブラリがwindowsで動かす想定な以上、windows以外での動作は確認していないわ。
ずんだもん＞マックとかリナックス派にはすまないのだ…
-->
## 設定(Extension Settings)

以下の設定ができます
* `vsCodeTalker.availableEngines`: 使用可能な音声合成ライブラリのリスト
* `vsCodeTalker.defaultLibraryName`: デフォルトの音声合成ライブラリのプリセット名、一致するプリセット名の音声合成ライブラリは読み上げライブラリの選択時に一番上に来ます
* `vsCodeTalker.notifyOnRead`: 音声の再生/録音後にメッセージを表示するか
* `vsCodeTalker.saveTextFileOnRecord`: 音声録音時、読み上げ内容を含むテキストファイルを生成するか
* `vsCodeTalker.ttsRecordFileFolder`: 音声録音時の.wavファイル出力先
* `vsCodeTalker.voicePresetSeparator`:ボイスプリセットの区切り文字として使う文字列、デフォルトでは「＞」
<!-- 
四国めたん＞次は設定内容よ。
四国めたん＞設定内容だけど、より良いネーミングがあったら更新するわ。
四国めたん＞通知の有無はユーザー操作で無効化できるようにはしたのだわ。
 -->
## 既知の問題点(Known Issues)

* 録音時
  * 録音中に再生した別の音声が録音されている
    * 仕様です、音声録音時にスピーカーから再生している音声をそのまま録音しているため起こります
  * (logicool G533で確認)録音したファイルを再生時、音量が小さくなる?
  * A.I.Voice,Voicevoxについては対応済み(それぞれ録音機能をAPIから使うよう修正しました)
* 読み上げ中に、別の読み上げを実行すると変な挙動になる
  * VOICEROID2,A.I.Voice → 音声再生中に別の読み上げを実行させると一時停止になる
  * VOICEVOX → 多重再生になる
  * Cevio AI → 前に実行した読み上げを中断し、次の読み上げを実行
* VOICEVOXについて、読み上げ時に自動起動されない
* voicepeakについて、ライブラリ名が日本語の場合文字化けし動作しない

<!-- 
四国めたん＞次に現状確認済みの問題点よ。。
ずんだもん＞まだ拡張機能を作ったばかりだから、バグがあったら作者に教えてほしいのだ！
ONE＞録音時にボリュームが低くなる事象は、他のパソコンだと問題なかったんだよね…
-->